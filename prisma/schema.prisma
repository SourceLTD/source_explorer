generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model frame_roles {
  created_at         DateTime             @default(now())
  updated_at         DateTime             @default(now())
  id                 BigInt               @id @default(autoincrement())
  frame_id           BigInt
  role_type_id       BigInt
  description        String?
  notes              String?
  main               Boolean?
  examples           String[]             @default([])
  label              String?
  version            Int                  @default(1)
  frames             frames               @relation(fields: [frame_id], references: [id], onDelete: Cascade)
  role_types         role_types           @relation(fields: [role_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  role_group_members role_group_members[]

  @@unique([frame_id, role_type_id], map: "uq_frame_role")
  @@unique([id, frame_id], map: "uq_frame_roles_id_frame")
}

model frames {
  label                                             String
  definition                                        String?
  short_definition                                  String?
  created_at                                        DateTime               @default(now())
  updated_at                                        DateTime               @default(now())
  id                                                BigInt                 @id @default(autoincrement())
  flagged                                           Boolean?               @default(false)
  flagged_reason                                    String?
  verifiable                                        Boolean?               @default(false)
  unverifiable_reason                               String?
  version                                           Int                    @default(1)
  embedding                                         Unsupported("vector")?
  deleted                                           Boolean                @default(false)
  deleted_at                                        DateTime?              @db.Timestamp(6)
  deleted_reason                                    String?
  super_frame_id                                    BigInt?
  code                                              String?
  frame_relations_frame_relations_source_idToframes frame_relations[]      @relation("frame_relations_source_idToframes")
  frame_relations_frame_relations_target_idToframes frame_relations[]      @relation("frame_relations_target_idToframes")
  frame_roles                                       frame_roles[]
  frames                                            frames?                @relation("framesToframes", fields: [super_frame_id], references: [id], map: "frames_super_frame_fk")
  other_frames                                      frames[]               @relation("framesToframes")
  lexical_units                                     lexical_units[]
  llm_job_items                                     llm_job_items[]
  recipe_predicates                                 recipe_predicates[]
  recipes                                           recipes[]
  role_groups                                       role_groups[]

  @@index([label], map: "idx_frames_frame_name")
  @@index([flagged], map: "idx_frames_flagged")
  @@index([embedding], map: "idx_frames_embedding")
  @@index([deleted], map: "idx_frames_deleted")
  @@index([verifiable], map: "idx_frames_verifiable")
  @@index([code], map: "idx_frames_code")
  @@index([super_frame_id], map: "idx_frames_super_frame_id")
}

model instantiation_types {
  label       String  @unique
  wikidata_id String? @unique
  id          BigInt  @id @default(autoincrement())
  code        String  @unique(map: "instantiation_types_code_unique") @db.VarChar
}

model role_types {
  label               String        @unique
  generic_description String
  explanation         String?
  id                  BigInt        @id @default(autoincrement())
  code                String        @unique(map: "role_types_code_unique") @db.VarChar
  frame_roles         frame_roles[]
}

model predicate_variable_types {
  label                          String                           @unique
  description                    String?
  unit                           String?
  created_at                     DateTime                         @default(now()) @db.Timestamp(6)
  updated_at                     DateTime                         @default(now()) @db.Timestamp(6)
  id                             BigInt                           @id @default(autoincrement())
  recipe_predicate_role_bindings recipe_predicate_role_bindings[]
  recipe_variables               recipe_variables[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model recipe_predicate_relations {
  properties                                                                                 Json?
  created_at                                                                                 DateTime          @default(now()) @db.Timestamp(6)
  updated_at                                                                                 DateTime          @default(now()) @db.Timestamp(6)
  id                                                                                         BigInt            @id @default(autoincrement())
  recipe_id                                                                                  BigInt
  source_recipe_predicate_id                                                                 BigInt
  target_recipe_predicate_id                                                                 BigInt
  recipes                                                                                    recipes           @relation(fields: [recipe_id], references: [id], onDelete: Cascade)
  recipe_predicates_recipe_predicate_relations_source_recipe_predicate_idTorecipe_predicates recipe_predicates @relation("recipe_predicate_relations_source_recipe_predicate_idTorecipe_predicates", fields: [source_recipe_predicate_id], references: [id], onDelete: Cascade)
  recipe_predicates_recipe_predicate_relations_target_recipe_predicate_idTorecipe_predicates recipe_predicates @relation("recipe_predicate_relations_target_recipe_predicate_idTorecipe_predicates", fields: [target_recipe_predicate_id], references: [id], onDelete: Cascade)

  @@index([recipe_id, source_recipe_predicate_id], map: "idx_recipe_pred_rel_recipe_source")
  @@index([recipe_id, target_recipe_predicate_id], map: "idx_recipe_pred_rel_recipe_target")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model recipe_predicate_role_bindings {
  bind_kind                  String
  constant                   Json?
  created_at                 DateTime                  @default(now()) @db.Timestamp(6)
  updated_at                 DateTime                  @default(now()) @db.Timestamp(6)
  id                         BigInt                    @id @default(autoincrement())
  recipe_predicate_id        BigInt
  predicate_role_id          BigInt
  verb_role_id               BigInt?
  predicate_variable_type_id BigInt?
  discovered                 Boolean?                  @default(false)
  variable_id                BigInt?
  recipe_variables           recipe_variables?         @relation(fields: [variable_id], references: [id], map: "fk_recipe_predicate_role_bindings_variable")
  predicate_variable_types   predicate_variable_types? @relation(fields: [predicate_variable_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  recipe_predicates          recipe_predicates         @relation(fields: [recipe_predicate_id], references: [id], onDelete: Cascade)

  @@unique([recipe_predicate_id, predicate_role_id], map: "uq_recipe_predicate_role_binding")
  @@index([variable_id], map: "idx_recipe_predicate_role_bindings_variable")
}

model recipe_predicates {
  alias                                                                                               String?
  position                                                                                            Int?
  created_at                                                                                          DateTime                         @default(now()) @db.Timestamp(6)
  updated_at                                                                                          DateTime                         @default(now()) @db.Timestamp(6)
  id                                                                                                  BigInt                           @id @default(autoincrement())
  recipe_id                                                                                           BigInt
  example                                                                                             String?
  commitment                                                                                          predicate_commitment             @default(asserted)
  predicate_frame_id                                                                                  BigInt?
  logic_targets                                                                                       logic_targets[]
  recipe_preconditions                                                                                recipe_preconditions[]
  recipe_predicate_relations_recipe_predicate_relations_source_recipe_predicate_idTorecipe_predicates recipe_predicate_relations[]     @relation("recipe_predicate_relations_source_recipe_predicate_idTorecipe_predicates")
  recipe_predicate_relations_recipe_predicate_relations_target_recipe_predicate_idTorecipe_predicates recipe_predicate_relations[]     @relation("recipe_predicate_relations_target_recipe_predicate_idTorecipe_predicates")
  recipe_predicate_role_bindings                                                                      recipe_predicate_role_bindings[]
  frames                                                                                              frames?                          @relation(fields: [predicate_frame_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  recipes                                                                                             recipes                          @relation(fields: [recipe_id], references: [id], onDelete: Cascade)

  @@index([commitment], map: "idx_recipe_predicates_commitment")
  @@index([predicate_frame_id], map: "idx_recipe_predicates_frame_id")
}

model recipes {
  label                                               String?
  description                                         String?
  is_default                                          Boolean                      @default(false)
  created_at                                          DateTime                     @default(now()) @db.Timestamp(6)
  updated_at                                          DateTime                     @default(now()) @db.Timestamp(6)
  id                                                  BigInt                       @id @default(autoincrement())
  example                                             String?
  logic_root_node_id                                  BigInt?
  version                                             Int                          @default(1)
  frame_id                                            BigInt?
  logic_nodes_logic_nodes_recipe_idTorecipes          logic_nodes[]                @relation("logic_nodes_recipe_idTorecipes")
  recipe_preconditions                                recipe_preconditions[]
  recipe_predicate_relations                          recipe_predicate_relations[]
  recipe_predicates                                   recipe_predicates[]
  recipe_variables                                    recipe_variables[]
  frames                                              frames?                      @relation(fields: [frame_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  logic_nodes_recipes_logic_root_node_idTologic_nodes logic_nodes?                 @relation("recipes_logic_root_node_idTologic_nodes", fields: [logic_root_node_id], references: [id], onUpdate: NoAction)

  @@index([frame_id], map: "idx_recipes_frame_id")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model recipe_preconditions {
  id                         BigInt             @id @default(autoincrement())
  recipe_id                  BigInt
  condition_type             String             @db.VarChar(50)
  target_role_id             BigInt?
  target_recipe_predicate_id BigInt?
  condition_params           Json?
  description                String?
  error_message              String?
  created_at                 DateTime           @default(now()) @db.Timestamp(6)
  updated_at                 DateTime           @default(now()) @db.Timestamp(6)
  recipe_predicates          recipe_predicates? @relation(fields: [target_recipe_predicate_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_recipe_preconditions_predicate")
  recipes                    recipes            @relation(fields: [recipe_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_recipe_preconditions_recipe")

  @@index([target_recipe_predicate_id], map: "idx_recipe_preconditions_predicate")
  @@index([recipe_id], map: "idx_recipe_preconditions_recipe")
  @@index([target_role_id], map: "idx_recipe_preconditions_role")
  @@index([condition_type], map: "idx_recipe_preconditions_type")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model role_group_members {
  id            BigInt      @id @default(autoincrement())
  role_group_id BigInt
  role_id       BigInt
  created_at    DateTime    @default(now()) @db.Timestamp(6)
  roles         frame_roles @relation(fields: [role_id], references: [id], onDelete: Cascade, map: "fk_role_group_members_role")
  role_groups   role_groups @relation(fields: [role_group_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_role_group_members_group")

  @@unique([role_group_id, role_id], map: "uq_role_group_member")
  @@index([role_group_id], map: "idx_role_group_members_group")
  @@index([role_id], map: "idx_role_group_members_role")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model role_groups {
  id                   BigInt               @id @default(autoincrement())
  description          String?
  require_at_least_one Boolean              @default(true)
  created_at           DateTime             @default(now()) @db.Timestamp(6)
  updated_at           DateTime             @default(now()) @db.Timestamp(6)
  frame_id             BigInt?
  role_group_members   role_group_members[]
  frames               frames?              @relation(fields: [frame_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([frame_id], map: "idx_role_groups_frame_id")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model logic_edges {
  id                                                  BigInt      @id @default(autoincrement())
  parent_node_id                                      BigInt
  child_node_id                                       BigInt
  position                                            Int?
  created_at                                          DateTime?   @default(now()) @db.Timestamp(6)
  logic_nodes_logic_edges_child_node_idTologic_nodes  logic_nodes @relation("logic_edges_child_node_idTologic_nodes", fields: [child_node_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  logic_nodes_logic_edges_parent_node_idTologic_nodes logic_nodes @relation("logic_edges_parent_node_idTologic_nodes", fields: [parent_node_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([parent_node_id, child_node_id])
  @@index([child_node_id], map: "idx_logic_edges_child")
  @@index([parent_node_id, position], map: "idx_logic_edges_parent_position")
}

model logic_nodes {
  id                                                  BigInt          @id @default(autoincrement())
  recipe_id                                           BigInt
  kind                                                logic_node_kind
  description                                         String?
  created_at                                          DateTime?       @default(now()) @db.Timestamp(6)
  updated_at                                          DateTime?       @default(now()) @db.Timestamp(6)
  natural_key                                         String?         @unique
  logic_edges_logic_edges_child_node_idTologic_nodes  logic_edges[]   @relation("logic_edges_child_node_idTologic_nodes")
  logic_edges_logic_edges_parent_node_idTologic_nodes logic_edges[]   @relation("logic_edges_parent_node_idTologic_nodes")
  recipes_logic_nodes_recipe_idTorecipes              recipes         @relation("logic_nodes_recipe_idTorecipes", fields: [recipe_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  logic_targets                                       logic_targets?
  recipes_recipes_logic_root_node_idTologic_nodes     recipes[]       @relation("recipes_logic_root_node_idTologic_nodes")

  @@index([recipe_id, kind], map: "idx_logic_nodes_recipe_kind")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model logic_targets {
  id                  BigInt             @id @default(autoincrement())
  node_id             BigInt             @unique
  recipe_predicate_id BigInt?
  predicate_group_id  BigInt?
  created_at          DateTime?          @default(now()) @db.Timestamp(6)
  logic_nodes         logic_nodes        @relation(fields: [node_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  recipe_predicates   recipe_predicates? @relation(fields: [recipe_predicate_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([predicate_group_id], map: "idx_logic_targets_group")
  @@index([recipe_predicate_id], map: "idx_logic_targets_predicate")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model recipe_variables {
  id                             BigInt                           @id @default(autoincrement())
  recipe_id                      BigInt
  key                            String
  predicate_variable_type_id     BigInt?
  default_value                  Json?
  created_at                     DateTime                         @default(now()) @db.Timestamp(6)
  updated_at                     DateTime                         @default(now()) @db.Timestamp(6)
  lexical_unit_id                BigInt?
  recipe_predicate_role_bindings recipe_predicate_role_bindings[]
  recipes                        recipes                          @relation(fields: [recipe_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_recipe_variables_recipe")
  predicate_variable_types       predicate_variable_types?        @relation(fields: [predicate_variable_type_id], references: [id], onUpdate: NoAction, map: "fk_recipe_variables_var_type")
  lexical_units                  lexical_units?                   @relation(fields: [lexical_unit_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([recipe_id, key], map: "uq_recipe_variables_recipe_key")
  @@index([key], map: "idx_recipe_variables_key")
  @@index([recipe_id], map: "idx_recipe_variables_recipe")
  @@index([lexical_unit_id], map: "idx_recipe_variables_lexical_unit")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model llm_job_items {
  id               BigInt              @id @default(autoincrement())
  job_id           BigInt
  status           llm_job_item_status @default(queued)
  attempt_count    Int                 @default(0)
  provider_task_id String?
  llm_request_id   String?
  request_payload  Json?
  response_payload Json?
  flags            Json?
  flagged          Boolean             @default(false)
  last_error       String?
  input_tokens     Int                 @default(0)
  output_tokens    Int                 @default(0)
  created_at       DateTime            @default(now()) @db.Timestamptz(6)
  started_at       DateTime?           @db.Timestamptz(6)
  completed_at     DateTime?           @db.Timestamptz(6)
  updated_at       DateTime            @default(now()) @db.Timestamptz(6)
  frame_id         BigInt?
  has_edits        Boolean?            @default(false)
  lexical_unit_id  BigInt?
  frames           frames?             @relation(fields: [frame_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  llm_jobs         llm_jobs            @relation(fields: [job_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  lexical_units    lexical_units?      @relation(fields: [lexical_unit_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([frame_id], map: "idx_llm_job_items_frame")
  @@index([lexical_unit_id], map: "idx_llm_job_items_lexical_unit")
}

model llm_jobs {
  id              BigInt          @id @default(autoincrement())
  label           String?
  submitted_by    String?
  scope_kind      String?
  scope           Json?
  config          Json?
  provider        String?
  provider_run_id String?
  llm_vendor      String?
  llm_request_id  String?
  status          llm_job_status  @default(queued)
  total_items     Int             @default(0)
  processed_items Int             @default(0)
  succeeded_items Int             @default(0)
  failed_items    Int             @default(0)
  flagged_items   Int             @default(0)
  input_tokens    Int             @default(0)
  output_tokens   Int             @default(0)
  cost_microunits BigInt?
  error           String?
  created_at      DateTime        @default(now()) @db.Timestamptz(6)
  started_at      DateTime?       @db.Timestamptz(6)
  completed_at    DateTime?       @db.Timestamptz(6)
  updated_at      DateTime        @default(now()) @db.Timestamptz(6)
  deleted         Boolean         @default(false)
  submitted_items Int             @default(0)
  unseen_change   Boolean         @default(false)
  job_type        llm_job_type?   @default(moderation)
  changesets      changesets[]
  llm_job_items   llm_job_items[]
}

model frame_relations {
  id                                       BigInt              @id @default(autoincrement())
  source_id                                BigInt
  target_id                                BigInt
  type                                     frame_relation_type
  created_at                               DateTime?           @default(now()) @db.Timestamp(6)
  updated_at                               DateTime?           @default(now()) @db.Timestamp(6)
  version                                  Int                 @default(1)
  frames_frame_relations_source_idToframes frames              @relation("frame_relations_source_idToframes", fields: [source_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_frame_relations_source")
  frames_frame_relations_target_idToframes frames              @relation("frame_relations_target_idToframes", fields: [target_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_frame_relations_target")

  @@unique([source_id, type, target_id], map: "uq_frame_relation")
  @@index([source_id], map: "idx_frame_relations_source")
  @@index([source_id, type], map: "idx_frame_relations_source_type")
  @@index([target_id], map: "idx_frame_relations_target")
  @@index([target_id, type], map: "idx_frame_relations_target_type")
  @@index([type], map: "idx_frame_relations_type")
}

model audit_log {
  id           BigInt           @id @default(autoincrement())
  entity_type  entity_type
  entity_id    BigInt
  field_name   String
  operation    change_operation
  old_value    Json?
  new_value    Json?
  changed_by   String
  changed_at   DateTime         @default(now()) @db.Timestamptz(6)
  changeset_id BigInt?
  changesets   changesets?      @relation(fields: [changeset_id], references: [id], onUpdate: NoAction)

  @@index([changed_at], map: "idx_audit_log_changed_at")
  @@index([changed_by], map: "idx_audit_log_changed_by")
  @@index([entity_type, entity_id], map: "idx_audit_log_entity")
}

model changesets {
  id              BigInt            @id @default(autoincrement())
  entity_type     entity_type
  entity_id       BigInt?
  operation       change_operation
  entity_version  Int?
  before_snapshot Json?
  after_snapshot  Json?
  status          changeset_status  @default(pending)
  created_by      String
  created_at      DateTime          @default(now()) @db.Timestamptz(6)
  reviewed_by     String?
  reviewed_at     DateTime?         @db.Timestamptz(6)
  committed_at    DateTime?         @db.Timestamptz(6)
  llm_job_id      BigInt?
  audit_log       audit_log[]
  ai_revisions    ai_revisions[]
  change_comments change_comments[]
  llm_jobs        llm_jobs?         @relation(fields: [llm_job_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_changesets_llm_job")
  comment_reads   comment_reads[]
  field_changes   field_changes[]

  @@index([created_at], map: "idx_changesets_created_at")
  @@index([created_by], map: "idx_changesets_created_by")
  @@index([entity_type, entity_id], map: "idx_changesets_entity")
  @@index([status], map: "idx_changesets_status")
  @@index([llm_job_id], map: "idx_changesets_llm_job")
}

model field_changes {
  id              BigInt              @id @default(autoincrement())
  changeset_id    BigInt
  field_name      String
  old_value       Json?
  new_value       Json?
  status          field_change_status @default(pending)
  approved_by     String?
  approved_at     DateTime?           @db.Timestamptz(6)
  rejected_by     String?
  rejected_at     DateTime?           @db.Timestamptz(6)
  change_comments change_comments[]
  changesets      changesets          @relation(fields: [changeset_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([changeset_id, field_name])
  @@index([changeset_id], map: "idx_field_changes_changeset")
  @@index([status], map: "idx_field_changes_status")
}

model change_comments {
  id              BigInt         @id @default(autoincrement())
  changeset_id    BigInt?
  field_change_id BigInt?
  author          String
  content         String
  created_at      DateTime       @default(now()) @db.Timestamptz(6)
  changesets      changesets?    @relation(fields: [changeset_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  field_changes   field_changes? @relation(fields: [field_change_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  ai_revision     ai_revisions?

  @@index([changeset_id], map: "idx_change_comments_changeset")
  @@index([field_change_id], map: "idx_change_comments_field_change")
}

model ai_revisions {
  id              BigInt             @id @default(autoincrement())
  changeset_id    BigInt
  comment_id      BigInt?            @unique
  action          String             @db.VarChar(20)
  modifications   Json?
  justification   String?
  confidence      Decimal?           @db.Decimal(3, 2)
  status          ai_revision_status @default(pending)
  accepted_fields Json?              @default("[]")
  rejected_fields Json?              @default("[]")
  created_at      DateTime           @default(now()) @db.Timestamptz(6)
  resolved_at     DateTime?          @db.Timestamptz(6)
  changesets      changesets         @relation(fields: [changeset_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  change_comments change_comments?   @relation(fields: [comment_id], references: [id], onDelete: SetNull, onUpdate: NoAction)

  @@index([changeset_id], map: "idx_ai_revisions_changeset")
  @@index([status], map: "idx_ai_revisions_status")
}

model comment_reads {
  id           BigInt     @id @default(autoincrement())
  user_id      String
  changeset_id BigInt
  last_read_at DateTime   @default(now()) @db.Timestamptz(6)
  changesets   changesets @relation(fields: [changeset_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([user_id, changeset_id], map: "uq_user_changeset_read")
  @@index([changeset_id], map: "idx_comment_reads_changeset")
  @@index([user_id], map: "idx_comment_reads_user")
}

model lexical_unit_relations {
  id                                                            BigInt                     @id @default(autoincrement())
  source_id                                                     BigInt
  target_id                                                     BigInt
  type                                                          lexical_unit_relation_type
  weight                                                        Float?
  properties                                                    Json?
  version                                                       Int?                       @default(1)
  created_at                                                    DateTime?                  @default(now()) @db.Timestamp(6)
  updated_at                                                    DateTime?                  @default(now()) @db.Timestamp(6)
  lexical_units_lexical_unit_relations_source_idTolexical_units lexical_units              @relation("lexical_unit_relations_source_idTolexical_units", fields: [source_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  lexical_units_lexical_unit_relations_target_idTolexical_units lexical_units              @relation("lexical_unit_relations_target_idTolexical_units", fields: [target_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([source_id, type, target_id])
  @@index([properties], map: "idx_lu_relations_properties", type: Gin)
  @@index([source_id], map: "idx_lu_relations_source")
  @@index([source_id, type], map: "idx_lu_relations_source_type")
  @@index([target_id], map: "idx_lu_relations_target")
  @@index([target_id, type], map: "idx_lu_relations_target_type")
  @@index([type], map: "idx_lu_relations_type")
}

model lexical_units {
  id                                                                     BigInt                   @id @default(autoincrement())
  pos                                                                    part_of_speech
  code                                                                   String                   @unique @db.VarChar
  legacy_id                                                              String                   @db.VarChar
  lemmas                                                                 String[]                 @default([])
  src_lemmas                                                             String[]                 @default([])
  gloss                                                                  String
  lexfile                                                                String                   @db.VarChar
  examples                                                               String[]                 @default([])
  is_mwe                                                                 Boolean?                 @default(false)
  flagged                                                                Boolean?                 @default(false)
  flagged_reason                                                         String?
  verifiable                                                             Boolean?                 @default(false)
  unverifiable_reason                                                    String?
  legal_gloss                                                            String?
  legal_constraints                                                      String[]
  deleted                                                                Boolean?                 @default(false)
  deleted_at                                                             DateTime?                @db.Timestamp(6)
  deleted_reason                                                         String?
  frame_id                                                               BigInt?
  gloss_tsv                                                              Unsupported("tsvector")?
  examples_tsv                                                           Unsupported("tsvector")?
  embedding                                                              Unsupported("vector")?
  version                                                                Int?                     @default(1)
  created_at                                                             DateTime?                @default(now()) @db.Timestamp(6)
  updated_at                                                             DateTime?                @default(now()) @db.Timestamp(6)
  vendler_class                                                          vendler_class_type?
  created_from                                                           String[]                 @default([])
  concrete                                                               Boolean?                 @default(false)
  countable                                                              Boolean?
  proper                                                                 Boolean?                 @default(false)
  collective                                                             Boolean?                 @default(false)
  predicate                                                              Boolean?                 @default(false)
  is_satellite                                                           Boolean?                 @default(false)
  gradable                                                               Boolean?
  predicative                                                            Boolean?                 @default(true)
  attributive                                                            Boolean?                 @default(true)
  subjective                                                             Boolean?                 @default(false)
  relational                                                             Boolean?                 @default(false)
  lexical_unit_relations_lexical_unit_relations_source_idTolexical_units lexical_unit_relations[] @relation("lexical_unit_relations_source_idTolexical_units")
  lexical_unit_relations_lexical_unit_relations_target_idTolexical_units lexical_unit_relations[] @relation("lexical_unit_relations_target_idTolexical_units")
  frames                                                                 frames?                  @relation(fields: [frame_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  llm_job_items                                                          llm_job_items[]
  recipe_variables                                                       recipe_variables[]

  @@unique([id, frame_id], map: "uq_lexical_unit_id_frame")
  @@index([deleted], map: "idx_lexical_units_deleted")
  @@index([examples_tsv], map: "idx_lexical_units_examples_tsv", type: Gin)
  @@index([flagged], map: "idx_lexical_units_flagged")
  @@index([frame_id], map: "idx_lexical_units_frame_id")
  @@index([gloss_tsv], map: "idx_lexical_units_gloss_tsv", type: Gin)
  @@index([lemmas], map: "idx_lexical_units_lemmas_gin", type: Gin)
  @@index([lexfile], map: "idx_lexical_units_lexfile")
  @@index([pos], map: "idx_lexical_units_pos")
  @@index([vendler_class], map: "idx_lexical_units_vendler_class")
  @@index([verifiable], map: "idx_lexical_units_verifiable")
}

enum vendler_class_type {
  state
  activity
  accomplishment
  achievement
}

enum logic_node_kind {
  and
  or
  not
  leaf
  enables
  causes
  precedes
  starts
  ends
  during
  co_temporal
}

enum predicate_commitment {
  asserted
  afforded
}

enum llm_job_item_status {
  queued
  submitting
  processing
  succeeded
  failed
  skipped
}

enum llm_job_status {
  queued
  running
  completed
  failed
  cancelled
  paused
}

enum frame_relation_type {
  causes
  inherits_from
  inherited_by
  uses
  used_by
  subframe_of
  has_subframe
  precedes
  preceded_by
  perspective_on
  perspectivized_in
  see_also
  reframing_mapping
  metaphor
}

enum change_operation {
  create
  update
  delete
}

enum changeset_status {
  pending
  committed
  discarded
}

enum entity_type {
  verb
  noun
  adjective
  adverb
  frame
  frame_role
  role
  recipe
  verb_relation
  noun_relation
  adjective_relation
  adverb_relation
  frame_relation
  lexical_unit
}

enum field_change_status {
  pending
  approved
  rejected
}

enum ai_revision_status {
  pending
  accepted
  rejected
  partial
}

enum llm_job_type {
  moderation
  editing
  reallocation
  review
  split
}

enum lexical_unit_relation_type {
  also_see
  causes
  entails
  hypernym
  hyponym
  starts
  ends
  precedes
  during
  enables
  do_again
  co_temporal
  instance_hypernym
  instance_hyponym
  meronym_part
  holonym_part
  meronym_member
  holonym_member
  meronym_substance
  holonym_substance
  similar_to
  attribute
  derivationally_related
  pertainym
  domain_topic
  domain_region
  domain_usage
  member_of_domain_topic
  member_of_domain_region
  member_of_domain_usage
  similar
  antonym
  exemplifies
  participle_of
  related_to
  also
}

enum part_of_speech {
  verb
  noun
  adjective
  adverb
}
